** == CLI版学生考试成绩管理系统 == **

# 通信消息转发系统 (SystemMessage)

## （一）系统简介

前后端数据交换的中心媒介
	
## （二）通信格式 MsgStruct struct

### 1. 通信确认码 CodeMsg byte

1. `0x00` - 确认 / 就绪 / 准备完成 / 查询但存在结果 / 查询但不存在结果
2. `0x01` - 无法操作 / 出现错误 / 抛出异常 / 无法读取 / 无法写入 / 文件缺失
3. `0x02` - 请求退出 / 关闭子线程

### 2. 通信用户码 CodeUser string

登录时产生，和学工号以及权限绑定，用于传递到子系统中的参数

### 3. 权限码 codePrivilege byte

当前操作的主体用户的权限：
1. `0x00` - 学生用户
2. `0x01` - 教师用户
3. `0x02` - 管理员用户

### 4. 功能码 CodeFunc byte

1. `0x01` - 日志系统
2. `0x02` - 信息系统
3. `0x03` - 行政系统
4. `0x04` - 考试系统

### 5. 通信内容 MsgContent any

参考子系统 - 通信格式的参数的实现

## （三）简明流程

1. 等待各子系统完成基本初始化接收指令
2. 告知客户端允许请求登录，并等待客户端通道
3. 收到客户端登录请求后转发给鉴权系统，并等待鉴权系统通道
4. 验证通过后生成唯一标识权限码（便于后期结合Redis拓展）
5. 将权限码和用户标识号绑定，并返回相应权限菜单的组合，等待客户端通道
6. 无限循环等待通道消息并解析：
	--  判断客户端通道消息的功能码
	--	if 退出：
			依次通知（`CodeMsg`==`0x02`）并等待各子系统退出（`CodeMsg`==`0x00`）
		elif 子系统：
			判断权限是否存在于所属权限变量中(可选，当前阶段无需考虑)
			随机产生通信用户码，并和用户通道绑定（便于日后拓展成多用户登录）
			整理格式，将数据直接传递给对应的子系统
	--  等待子系统通道，并返回结果数据给客户端